(()=>{var ne=Object.create;var U=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ie=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var le=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var de=(t,o,n,s)=>{if(o&&typeof o=="object"||typeof o=="function")for(let c of ae(o))!se.call(t,c)&&c!==n&&U(t,c,{get:()=>o[c],enumerable:!(s=re(o,c))||s.enumerable});return t};var ce=(t,o,n)=>(n=t!=null?ne(ie(t)):{},de(o||!t||!t.__esModule?U(n,"default",{value:t,enumerable:!0}):n,t));var q=le(B=>{var Ce=function(){"use strict";let t="1.1.0";function o(e){alert(`Mod ERROR:
`+e);let i=new Error(e);throw console.error(i),i}let n=new TextEncoder;function s(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function c(e){let i=new Set;return e.filter(a=>!i.has(a)&&i.add(a))}let w=new Map,u=new Set;function M(e){u.has(e)||(u.add(e),console.warn(e))}function P(e){let i=[],a=new Map,l=new Set;for(let f of x.values()){let h=f.patching.get(e.name);if(h){i.push(...h.hooks);for(let[d,r]of h.patches.entries())a.has(d)&&a.get(d)!==r&&M(`ModSDK: Mod '${f.name}' is patching function ${e.name} with same pattern that is already applied by different mod, but with different pattern:
Pattern:
${d}
Patch1:
${a.get(d)||""}
Patch2:
${r}`),a.set(d,r),l.add(f.name)}}i.sort((f,h)=>h.priority-f.priority);let y=function(f,h){if(h.size===0)return f;let d=f.toString().replaceAll(`\r
`,`
`);for(let[r,p]of h.entries())d.includes(r)||M(`ModSDK: Patching ${f.name}: Patch ${r} not applied`),d=d.replaceAll(r,p);return(0,eval)(`(${d})`)}(e.original,a),k=function(f){var h,d;let r=(d=(h=j.errorReporterHooks).hookChainExit)===null||d===void 0?void 0:d.call(h,e.name,l),p=y.apply(this,f);return r?.(),p};for(let f=i.length-1;f>=0;f--){let h=i[f],d=k;k=function(r){var p,g;let v=(g=(p=j.errorReporterHooks).hookEnter)===null||g===void 0?void 0:g.call(p,e.name,h.mod),E=h.hook.apply(this,[r,R=>{if(arguments.length!==1||!Array.isArray(r))throw new Error(`Mod ${h.mod} failed to call next hook: Expected args to be array, got ${typeof R}`);return d.call(this,R)}]);return v?.(),E}}return{hooks:i,patches:a,patchesSources:l,enter:k,final:y}}function $(e,i=!1){let a=w.get(e);if(a)i&&(a.precomputed=P(a));else{let l=window,y=e.split(".");for(let d=0;d<y.length-1;d++)if(l=l[y[d]],!s(l))throw new Error(`ModSDK: Function ${e} to be patched not found; ${y.slice(0,d+1).join(".")} is not object`);let k=l[y[y.length-1]];if(typeof k!="function")throw new Error(`ModSDK: Function ${e} to be patched not found`);let f=function(d){let r=-1;for(let p of n.encode(d)){let g=255&(r^p);for(let v=0;v<8;v++)g=1&g?-306674912^g>>>1:g>>>1;r=r>>>8^g}return((-1^r)>>>0).toString(16).padStart(8,"0").toUpperCase()}(k.toString().replaceAll(`\r
`,`
`)),h={name:e,original:k,originalHash:f};a=Object.assign(Object.assign({},h),{precomputed:P(h),router:()=>{},context:l,contextProperty:y[y.length-1]}),a.router=function(d){return function(...r){return d.precomputed.enter.apply(this,[r])}}(a),w.set(e,a),l[a.contextProperty]=a.router}return a}function C(){let e=new Set;for(let i of x.values())for(let a of i.patching.keys())e.add(a);for(let i of w.keys())e.add(i);for(let i of e)$(i,!0)}function O(){let e=new Map;for(let[i,a]of w)e.set(i,{name:i,original:a.original,originalHash:a.originalHash,sdkEntrypoint:a.router,currentEntrypoint:a.context[a.contextProperty],hookedByMods:c(a.precomputed.hooks.map(l=>l.mod)),patchedByMods:Array.from(a.precomputed.patchesSources)});return e}let x=new Map;function T(e){x.get(e.name)!==e&&o(`Failed to unload mod '${e.name}': Not registered`),x.delete(e.name),e.loaded=!1,C()}function L(e,i,a){typeof e=="string"&&typeof i=="string"&&(alert(`Mod SDK warning: Mod '${e}' is registering in a deprecated way.
It will work for now, but please inform author to update.`),e={name:e,fullName:e,version:i},i={allowReplace:a===!0}),e&&typeof e=="object"||o("Failed to register mod: Expected info object, got "+typeof e),typeof e.name=="string"&&e.name||o("Failed to register mod: Expected name to be non-empty string, got "+typeof e.name);let l=`'${e.name}'`;typeof e.fullName=="string"&&e.fullName||o(`Failed to register mod ${l}: Expected fullName to be non-empty string, got ${typeof e.fullName}`),l=`'${e.fullName} (${e.name})'`,typeof e.version!="string"&&o(`Failed to register mod ${l}: Expected version to be string, got ${typeof e.version}`),e.repository||(e.repository=void 0),e.repository!==void 0&&typeof e.repository!="string"&&o(`Failed to register mod ${l}: Expected repository to be undefined or string, got ${typeof e.version}`),i==null&&(i={}),i&&typeof i=="object"||o(`Failed to register mod ${l}: Expected options to be undefined or object, got ${typeof i}`);let y=i.allowReplace===!0,k=x.get(e.name);k&&(k.allowReplace&&y||o(`Refusing to load mod ${l}: it is already loaded and doesn't allow being replaced.
Was the mod loaded multiple times?`),T(k));let f=r=>{typeof r=="string"&&r||o(`Mod ${l} failed to patch a function: Expected function name string, got ${typeof r}`);let p=d.patching.get(r);return p||(p={hooks:[],patches:new Map},d.patching.set(r,p)),p},h={unload:()=>T(d),hookFunction:(r,p,g)=>{d.loaded||o(`Mod ${l} attempted to call SDK function after being unloaded`);let v=f(r);typeof p!="number"&&o(`Mod ${l} failed to hook function '${r}': Expected priority number, got ${typeof p}`),typeof g!="function"&&o(`Mod ${l} failed to hook function '${r}': Expected hook function, got ${typeof g}`);let E={mod:d.name,priority:p,hook:g};return v.hooks.push(E),C(),()=>{let R=v.hooks.indexOf(E);R>=0&&(v.hooks.splice(R,1),C())}},patchFunction:(r,p)=>{d.loaded||o(`Mod ${l} attempted to call SDK function after being unloaded`);let g=f(r);s(p)||o(`Mod ${l} failed to patch function '${r}': Expected patches object, got ${typeof p}`);for(let[v,E]of Object.entries(p))typeof E=="string"?g.patches.set(v,E):E===null?g.patches.delete(v):o(`Mod ${l} failed to patch function '${r}': Invalid format of patch '${v}'`);C()},removePatches:r=>{d.loaded||o(`Mod ${l} attempted to call SDK function after being unloaded`),f(r).patches.clear(),C()},callOriginal:(r,p,g)=>(d.loaded||o(`Mod ${l} attempted to call SDK function after being unloaded`),typeof r=="string"&&r||o(`Mod ${l} failed to call a function: Expected function name string, got ${typeof r}`),Array.isArray(p)||o(`Mod ${l} failed to call a function: Expected args array, got ${typeof p}`),function(v,E,R=window){return $(v).original.apply(R,E)}(r,p,g)),getOriginalHash:r=>(typeof r=="string"&&r||o(`Mod ${l} failed to get hash: Expected function name string, got ${typeof r}`),$(r).originalHash)},d={name:e.name,fullName:e.fullName,version:e.version,repository:e.repository,allowReplace:y,api:h,loaded:!0,patching:new Map};return x.set(e.name,d),Object.freeze(h)}function oe(){let e=[];for(let i of x.values())e.push({name:i.name,fullName:i.fullName,version:i.version,repository:i.repository});return e}let j,z=function(){if(window.bcModSdk===void 0)return window.bcModSdk=function(){let e={version:t,apiVersion:1,registerMod:L,getModsInfo:oe,getPatchingInfo:O,errorReporterHooks:Object.seal({hookEnter:null,hookChainExit:null})};return j=e,Object.freeze(e)}();if(s(window.bcModSdk)||o("Failed to init Mod SDK: Name already in use"),window.bcModSdk.apiVersion!==1&&o(`Failed to init Mod SDK: Different version already loaded ('1.1.0' vs '${window.bcModSdk.version}')`),window.bcModSdk.version!==t&&(alert(`Mod SDK warning: Loading different but compatible versions ('1.1.0' vs '${window.bcModSdk.version}')
One of mods you are using is using an old version of SDK. It will work for now but please inform author to update`),window.bcModSdk.version.startsWith("1.0.")&&window.bcModSdk._shim10register===void 0)){let e=window.bcModSdk,i=Object.freeze(Object.assign(Object.assign({},e),{registerMod:(a,l,y)=>a&&typeof a=="object"&&typeof a.name=="string"&&typeof a.version=="string"?e.registerMod(a.name,a.version,typeof l=="object"&&!!l&&l.allowReplace===!0):e.registerMod(a,l,y),_shim10register:!0}));window.bcModSdk=i}return window.bcModSdk}();return typeof B<"u"&&(Object.defineProperty(B,"__esModule",{value:!0}),B.default=z),z}()});function I(t){return Math.floor(Math.random()*t)}function V(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function Y(t,o=3e3){ServerBeep={Timer:CommonTime()+o,Message:t}}function m(t,o="#6e6eff54",n,s){let c=document.createElement("div");c.setAttribute("class","ChatMessage ChatMessageLocalMessage"),c.setAttribute("data-time",ChatRoomCurrentTime()),c.setAttribute("data-sender",`${s??Player.MemberNumber??0}`),c.style.background=o,c.style.margin="0.15em 0",typeof t=="string"?c.innerText="[AES] "+t:c.appendChild("[AES] "+t);let w=document.activeElement?.id==="InputChat",u=ElementIsScrolledToEnd("TextAreaChatLog"),M=document.getElementById("TextAreaChatLog");return M!=null?(M.appendChild(c),u&&ElementScrollToEnd("TextAreaChatLog"),w&&ElementFocus("InputChat"),c):null}function X(){for(var t in ChatRoomCharacter)ChatRoomCharacterUpdate(t)}function K(t,o="btn",n="white",s=50,c=50){var w=document.getElementById("MainCanvas"),u=document.createElement("div");u.textContent=o,u.style.backgroundColor=n,u.style.width="40px",u.style.height="40px",u.style.position="absolute";var M=w.getBoundingClientRect();u.style.left=M.left+s+"px",u.style.top=M.top+c+"px",u.addEventListener("click",function(){t()}),w.appendChild(u),document.body.appendChild(u)}var te=ce(q());function b(t,o,n,s,c,w=!1){InventoryGet(t,n)==null&&InventoryWear(Player,o,n,s,c,!1)}function J(t){let o=["Cloth","ClothAccessory","Suit","ClothLower","SuitLower","Bra","Corset","Panties","SocksLeft","SocksRight","Socks","Garters","Shoes","Hat","Gloves","LeftHand","RightHand","Bracelet","Mask"],n=[];for(let s of o)InventoryGet(t,s)!=null&&n.push(s);if(n.length>0){let s=I(n.length);return InventoryRemove(t,n[s]),!0}else return CharacterNaked(Player),!1}var ee,F=0,S="#56AB56",_=3,Q=["The relentless vines tore through my clothing as if they were ravenous for flesh.","With a ruthless determination, the sinewy vines shredded my attire into tatters.","The invasive vines left me exposed, ripping my clothes to shreds with their tenacious grip.","As the voracious vines ensnared me, my clothes fell victim to their insatiable appetite.","My garments were no match for the relentless onslaught of the entangling vines.","The vines didn't discriminate, mercilessly tearing apart both fabric and dignity.","In their unyielding grasp, the vines left my clothing in tatters, exposing my vulnerability.","The tenacious vines stripped away my defenses, leaving me exposed and helpless.","As the plant's grip tightened, my clothes succumbed to the relentless force of nature.","My attire disintegrated under the relentless assault of the encroaching vines, leaving me vulnerable to their relentless advance."],A={head:0,mouth:0,mouth2:0,mouth3:0,neck:0,arms:0,pelvis:0,torso:0,torso2:0,legs:0,feet:0,boots:0};function N(){console.log("AES: A plant invasion has started"),m("A plant invasion has started"),D("PlantEvent","init"),ee=setInterval(function(){ue()},_*1e3)}function G(){console.log("AES: A plant invasion has finished"),m("A plant invasion has finished"),clearInterval(ee);for(var t in A)A[t]=0;D("PlantEvent","end",Player)}function ue(){var t=0;for(var o in A)t+=A[o];F++;let n=I(51)+F*5+t;ge("Some vines are approaching to you, do you want to fight back?","#6e6eff54",null,()=>{Z(n,I(101))},()=>{Z(n,0),console.log("Rendirse")},_*1e3),D("PlantEvent","test",Player)}function Z(t,o){var n=`You fought against the plants: 
 You: `+o+" - Vines: "+t;if(t>o){var s=I(2);s==0&&H()!=null||s==1&&H()!=null&&CharacterIsNaked(Player)?(n+=`
 Vines are looking to restrain your body.`,m(n,"#FFF2CC"),pe()):s==1&&!CharacterIsNaked(Player)||s==0&&!CharacterIsNaked(Player)&&H()==null?(n+=`
 Vines are tearing down your clothing.`,m(n,"#FFF2CC"),he()):(n+=`
 Vines stopped moving as they got you fully bound.`,m(n,"#FFF2CC"),G()),F=0}else m(n,"#FFF2CC");console.log("[AES] eventLevel up! - "+F),X()}function pe(){var t=H();switch(A[t.bind]++,t.bind){case"head":b(Player,"RopeBlindfold","ItemHead",S,1),m("The vines, like stealthy intruders, approached your face. With a swift and deliberate move, they placed a leafy blindfold over your eyes, shrouding you in impenetrable darkness.");break;case"mouth":b(Player,"ClothStuffing","ItemMouth",S,1),m("The vines swiftly moved towards your mouth, coiling tightly with a sinister intent.");break;case"mouth2":b(Player,"HempRope","ItemMouth2",S,1),m("The menacing vines lunged at your mouth, their aggressive coils silencing your protests with a brutal grip.");break;case"mouth3":b(Player,"ClothGag","ItemMouth3","#357035",1),m("The voracious vines lunged at your gaping mouth, their snakelike coils wrapping your throat in a strangling grip, rendering you speechless and breathless.");break;case"neck":b(Player,"NeckRope","ItemNeck",S,1),m("The relentless vines closed in on your neck, their grip unyielding, constricting like a tightening noose.");break;case"arms":b(Player,"HempRope","ItemArms",S,1),m("The vines slithered up your arms, coiling and constricting as they entangled you.");break;case"torso":b(Player,"HempRopeHarness","ItemTorso",S,1),m("The vines slithered up your arms, coiling and constricting as they entangled you.");break;case"torso2":b(Player,"HempRopeHarness","ItemTorso2",S,1),m("The vines slithered up your arms, coiling and constricting as they entangled you.");break;case"pelvis":b(Player,"HempRope","ItemPelvis",S,1),m("The vines slithered up your arms, coiling and constricting as they entangled you.");break;case"legs":b(Player,"HempRope","ItemLegs",S,1),m("The plant's sinuous tendrils coiled around your thighs, slowly constricting and pulling you deeper into their verdant embrace.");break;case"feet":b(Player,"HempRope","ItemFeet",S,1),m("The plant wraps around your legs, twisting and tightening its grip.");break;case"boots":b(Player,"ToeTie","ItemBoots",S,1),m("The massive, sinewy vines slithered around your fingers like living ropes, binding them together with an unbreakable, natural restraint.");break;default:break}}function fe(){let t=Math.floor(Math.random()*Q.length);return Q[t]}function he(){let t=fe();J(Player)&&m(t)}function H(){var t=[];for(var o in A)A[o]==0&&t.push(o);if(t.length>0){var n=Math.floor(Math.random()*t.length),s=t[n];return{bind:s,value:A[s]}}else return null}function me(){let t=F/6*100,o=document.createElement("div");o.classList.add("maxLevel-bar"),o.style.width="200px",o.style.height="20px";let n=document.createElement("div");n.classList.add("eventLevel-fill"),n.style.width=`${t}%`,o.appendChild(n);let s=`
    .maxLevel-bar {
    width: 300px;
    background-color: #ccc;
    border: 1px solid #000;
    text-align: center;
    font-size: 18px;
    }
    .eventLevel-fill {
    background-color: #ea9999;
    color: #fff;
    height: 100%;
    }
    `,c=document.createElement("style");return c.innerHTML=s,document.head.appendChild(c),o}function ge(t,o="#6e6eff54",n,s,c,w=_*1e3){let u=document.createElement("div");u.setAttribute("class","ChatMessage ChatMessageLocalMessage"),u.setAttribute("data-time",ChatRoomCurrentTime()),u.setAttribute("data-sender",`${n??Player.MemberNumber??0}`),u.style.background=o,u.style.margin="0.15em 0";let M=typeof t=="string"?t:"[AES] "+t,P=document.createElement("div");P.innerText=M,u.appendChild(P),eventLevelBar=me(),u.appendChild(eventLevelBar);let $=document.createElement("button");$.classList.add("fancy-button"),$.innerHTML="&#10003;",$.addEventListener("click",()=>{s&&(s(),L())});let C=document.createElement("button");C.classList.add("fancy-button"),C.innerHTML="&#10007;",C.addEventListener("click",()=>{c&&(c(),L())}),u.appendChild($),u.appendChild(C),setTimeout(()=>{c(),L()},w);let O=document.activeElement?.id==="InputChat",x=ElementIsScrolledToEnd("TextAreaChatLog"),T=document.getElementById("TextAreaChatLog");if(T!=null)return T.appendChild(u),x&&ElementScrollToEnd("TextAreaChatLog"),O&&ElementFocus("InputChat"),u;return null;function L(){u.remove()}}var ye=te.default.registerMod({name:"AES",fullName:"Ainaras Event Mod",version:"0.01",repository:"https://github.com/Ainaradev7/AES"});function W(t,o,n,s=null){return ve(t,o,n,s)}function ve(t,o,n,s=null){let c=ye.hookFunction(t,o,n)}function D(t,o,n=null){ServerSend("ChatRoomChat",{Content:"AESMsg",Type:"Hidden",Dictionary:{[t]:o}})}W("ChatRoomMessage",10,(t,o)=>{let n=t[0];if(n?.Type==="Hidden"&&n.Content==="AESMsg"&&typeof n.Sender=="number"){if(console.log("OWN MESSAGE ${data.sender} and ${message} from "+n.Sender),n.Sender===Player.MemberNumber)return;let{type:s,message:c}=n.Dictionary;if(typeof s=="string")switch(console.log("Received some data from AES"),console.log("`${data.sender} and ${message} from "+n.Sender),s){case"PlantEvent":c==="init"&&N();default:break}return}return o(t)});function be(){console.log("AES: Initiated"),CurrentScreen==null||CurrentScreen==="Login"?(W("LoginResponse",0,(t,o)=>{console.debug("AES: Init LoginResponse caught",t),o(t);let n=t[0];V(n)&&typeof n.Name=="string"&&n.AccountName}),Y("AES Ready!"),console.log("[AES] initiated"),K(()=>{N()},"start","green",50,50),K(()=>{G()},"stop","red",100,100)):console.debug("BCX: Already logged in, init")}be();})();
